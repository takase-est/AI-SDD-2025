# 要求定義書（RDD）

**プロダクト名:** CYSHELF - 蔵書管理システム  
**作成日:** 2025-12-18  
**バージョン:** 0.1  
**作成者:** 開発チーム

## 1. はじめに

### 1.1 本書の目的
本書は、CYSHELF蔵書管理システムの機能要件と非機能要件を明確化し、開発・試験へ引き渡すための要求定義書である。

### 1.2 対象読者
- 開発者
- システムアーキテクト
- テスト担当者
- プロジェクトマネージャー

### 1.3 関連文書
- `docs/FEATURES.md`（機能一覧ドキュメント）
- `docs/00_CLIENT.md`（クライアントヒアリング議事録）

### 1.4 用語定義
- **蔵書:** ユーザーが管理する書籍データ
- **読書状況:** 書籍の読了状態（未読/読書中/読了）
- **アクティビティログ:** システム内で実行された操作の履歴
- **CSV:** カンマ区切り値形式のファイル

---

## 2. 機能要件

### 2.1 書籍管理機能

#### FR.2.1.1 書籍の追加
- **要件:** ユーザーは新しい書籍を手動で登録できる。
- **入力項目:**
  - タイトル（必須）
  - 著者（必須）
  - 出版社（任意）
  - 出版年（必須、デフォルト: 現在の年）
  - ISBN（任意）
  - 読書状況（未読/読書中/読了、デフォルト: 未読）
  - お気に入り（デフォルト: false）
- **受け入れ基準:**
  - AC.2.1.1.1: 必須項目（タイトル、著者、出版年）が入力されている場合のみ登録可能
  - AC.2.1.1.2: 登録時に一意のIDと登録日時が自動付与される
  - AC.2.1.1.3: 登録後、アクティビティログに「書籍を新規登録しました」が記録される
  - AC.2.1.1.4: 登録後、書籍一覧に即座に反映される

#### FR.2.1.2 書籍の削除
- **要件:** ユーザーは登録済みの書籍を削除できる。
- **受け入れ基準:**
  - AC.2.1.2.1: 削除ボタンクリック時に確認モーダルが表示される
  - AC.2.1.2.2: 確認後に削除が実行される
  - AC.2.1.2.3: 削除後、アクティビティログに「書籍を削除しました」が記録される
  - AC.2.1.2.4: 削除後、書籍一覧から即座に削除される
  - AC.2.1.2.5: 最後のページの最後の1件を削除した場合、前のページに自動遷移する

#### FR.2.1.3 書籍情報の表示
- **要件:** ユーザーは登録済みの書籍を一覧表示できる。
- **表示項目:**
  - 操作ボタン（お気に入り、削除）
  - 読書状況
  - 書籍名
  - 著者
  - 出版社
  - 出版年
  - ISBN
- **受け入れ基準:**
  - AC.2.1.3.1: テーブル形式で一覧表示される
  - AC.2.1.3.2: すべての登録済み書籍が表示される
  - AC.2.1.3.3: 出版社が空の場合は「不明」と表示される
  - AC.2.1.3.4: ISBNが空の場合は「---」と表示される

---

### 2.2 検索・フィルタリング機能

#### FR.2.2.1 検索機能
- **要件:** ユーザーは書籍をタイトル、著者、出版社、ISBNで検索できる。
- **検索対象:**
  - タイトル（部分一致、大文字小文字区別なし）
  - 著者（部分一致、大文字小文字区別なし）
  - 出版社（部分一致、大文字小文字区別なし）
  - ISBN（部分一致、大文字小文字区別なし）
- **受け入れ基準:**
  - AC.2.2.1.1: 検索クエリ入力時にリアルタイムで結果が更新される
  - AC.2.2.1.2: 検索結果が0件の場合、「データが見つかりません」と表示される
  - AC.2.2.1.3: 検索クエリが空の場合、すべての書籍が表示される
  - AC.2.2.1.4: 検索実行時にページが1ページ目にリセットされる

---

### 2.3 ソート機能

#### FR.2.3.1 カラムソート
- **要件:** ユーザーはテーブルの各カラムをクリックしてソートできる。
- **ソート対象カラム:**
  - 状態（status）
  - 書籍名（title）
  - 著者（author）
  - 出版社（publisher）
  - 出版年（publishedYear）
  - ISBN（isbn）
- **受け入れ基準:**
  - AC.2.3.1.1: カラムヘッダークリックでソートが実行される
  - AC.2.3.1.2: 同じカラムを再度クリックすると昇順/降順が切り替わる
  - AC.2.3.1.3: 現在のソート状態が視覚的に表示される（ソートアイコン）
  - AC.2.3.1.4: ソート方向は昇順（asc）/ 降順（desc）を切り替え可能

---

### 2.4 ページネーション機能

#### FR.2.4.1 ページ分割表示
- **要件:** ユーザーは書籍一覧をページごとに分割して表示できる。
- **設定:** 1ページあたり5件
- **受け入れ基準:**
  - AC.2.4.1.1: 書籍が6件以上の場合、ページネーションが表示される
  - AC.2.4.1.2: 「前へ」「次へ」ボタンでページ遷移が可能
  - AC.2.4.1.3: デスクトップではページ番号が表示される
  - AC.2.4.1.4: 現在の表示範囲（例: 1-5 / 全10件）が表示される
  - AC.2.4.1.5: 最初のページでは「前へ」ボタンが無効化される
  - AC.2.4.1.6: 最後のページでは「次へ」ボタンが無効化される

---

### 2.5 CSVインポート/エクスポート機能

#### FR.2.5.1 CSVインポート
- **要件:** ユーザーはCSVファイルから書籍データを一括インポートできる。
- **CSV形式:**
  - ヘッダー行: `title,author,publisher,publishedYear,isbn,status,isFavorite`
  - 必須項目: `title`, `author`
  - 任意項目: `publisher`, `publishedYear`, `isbn`, `status`, `isFavorite`
- **受け入れ基準:**
  - AC.2.5.1.1: CSVファイルを選択してインポートできる
  - AC.2.5.1.2: ヘッダー行は無視される
  - AC.2.5.1.3: タイトルと著者が同じ書籍は重複としてスキップされる
  - AC.2.5.1.4: インポート後、追加件数とスキップ件数がアラートで表示される
  - AC.2.5.1.5: インポート後、アクティビティログに記録される
  - AC.2.5.1.6: 不正なCSV形式の場合、エラーメッセージが表示される

#### FR.2.5.2 CSVエクスポート
- **要件:** ユーザーは登録済みの全書籍データをCSV形式でエクスポートできる。
- **受け入れ基準:**
  - AC.2.5.2.1: エクスポートボタンクリックでCSVファイルがダウンロードされる
  - AC.2.5.2.2: ファイル名は `Library_Export_YYYY-MM-DD.csv` 形式
  - AC.2.5.2.3: UTF-8 BOM付きCSVファイルが生成される
  - AC.2.5.2.4: すべての書籍データが含まれる
  - AC.2.5.2.5: エクスポート後、アクティビティログに記録される

---

### 2.6 お気に入り機能

#### FR.2.6.1 お気に入りの登録/解除
- **要件:** ユーザーは書籍をお気に入りに登録または解除できる。
- **受け入れ基準:**
  - AC.2.6.1.1: ハートアイコンをクリックして切り替えが可能
  - AC.2.6.1.2: お気に入り状態が視覚的に表示される
  - AC.2.6.1.3: お気に入り登録/解除後、アクティビティログに記録される
  - AC.2.6.1.4: お気に入り状態が永続化される

---

### 2.7 読書状況管理機能

#### FR.2.7.1 読書状況の変更
- **要件:** ユーザーは書籍の読書状況を管理できる。
- **状態:**
  - 未読（unread）
  - 読書中（reading）
  - 読了（read）
- **受け入れ基準:**
  - AC.2.7.1.1: 状態バッジをクリックして循環的に切り替えが可能（未読 → 読書中 → 読了 → 未読）
  - AC.2.7.1.2: 各状態に応じた色分け表示が行われる
  - AC.2.7.1.3: 状態変更後、アクティビティログに記録される
  - AC.2.7.1.4: 状態が永続化される

---

### 2.8 統計情報表示機能

#### FR.2.8.1 ダッシュボード統計
- **要件:** ユーザーは蔵書の統計情報を確認できる。
- **表示項目:**
  - 総蔵書数
  - 読書状況（読了率、読了数、読書中数）
  - お気に入り数
- **受け入れ基準:**
  - AC.2.8.1.1: 統計情報がカード形式で表示される
  - AC.2.8.1.2: 読了率は「読了数 / 総蔵書数 × 100」で計算される
  - AC.2.8.1.3: 書籍データが変更されると統計情報が自動更新される

---

### 2.9 アクティビティログ機能

#### FR.2.9.1 操作履歴の記録と表示
- **要件:** システムはすべての操作を履歴として記録・表示する。
- **記録される操作:**
  - 書籍の追加（add）
  - 書籍の削除（delete）
  - 読書状況の変更（status）
  - お気に入りの登録/解除（favorite）
  - CSVインポート（import）
  - CSVエクスポート（export）
  - システム操作（system）
- **受け入れ基準:**
  - AC.2.9.1.1: すべての操作がアクティビティログに記録される
  - AC.2.9.1.2: タイムライン形式で表示される
  - AC.2.9.1.3: 操作タイプごとにアイコンと色分けが表示される
  - AC.2.9.1.4: タイムスタンプが日本語形式で表示される
  - AC.2.9.1.5: 最新の操作が上に表示される
  - AC.2.9.1.6: アクティビティログが永続化される

---

### 2.10 UI機能

#### FR.2.10.1 サイドバーナビゲーション
- **要件:** ユーザーはサイドバーでメインビューを切り替えられる。
- **ビュー:**
  - ダッシュボード（書籍一覧）
  - アクティビティ（操作履歴）
  - ヘルプ（使用方法）
- **受け入れ基準:**
  - AC.2.10.1.1: サイドバーでビューを切り替えられる
  - AC.2.10.1.2: 現在のビューが視覚的に強調表示される
  - AC.2.10.1.3: モバイルではオーバーレイ表示される
  - AC.2.10.1.4: モバイルではメニューボタンで開閉できる

#### FR.2.10.2 モーダルダイアログ
- **要件:** ユーザーはモーダルダイアログで書籍追加フォームや削除確認を表示できる。
- **受け入れ基準:**
  - AC.2.10.2.1: ESCキーでモーダルを閉じられる
  - AC.2.10.2.2: 背景クリックでモーダルを閉じられる
  - AC.2.10.2.3: モーダル表示時に背景が暗転する
  - AC.2.10.2.4: モーダル表示時に背景のスクロールが無効化される

#### FR.2.10.3 レスポンシブデザイン
- **要件:** システムはデスクトップとモバイルに対応する。
- **受け入れ基準:**
  - AC.2.10.3.1: デスクトップ（768px以上）で適切に表示される
  - AC.2.10.3.2: モバイル（768px未満）で適切に表示される
  - AC.2.10.3.3: モバイルでは検索バーが専用エリアに表示される
  - AC.2.10.3.4: テーブルは横スクロール可能

---

### 2.11 データ永続化機能

#### FR.2.11.1 ローカルストレージ保存
- **要件:** システムはデータを自動保存する。
- **保存データ:**
  - 書籍データ
  - アクティビティログ
- **受け入れ基準:**
  - AC.2.11.1.1: データ変更時に自動保存される
  - AC.2.11.1.2: ページリロード後もデータが保持される
  - AC.2.11.1.3: データはJSON形式で保存される

#### FR.2.11.2 データの初期化
- **要件:** ユーザーはデータを初期状態にリセットできる。
- **受け入れ基準:**
  - AC.2.11.2.1: 初期化ボタンクリック時に確認ダイアログが表示される
  - AC.2.11.2.2: 確認後に初期データ（サンプルデータ）に戻る
  - AC.2.11.2.3: アクティビティログも初期化される
  - AC.2.11.2.4: 初期化後、アクティビティログに記録される

---

### 2.12 ヘルプ機能

#### FR.2.12.1 ヘルプビュー
- **要件:** ユーザーはシステムの使用方法を確認できる。
- **内容:**
  - CSVインポート仕様の説明
  - データ保存について
  - データ削除について
  - CSVフォーマットのサンプル
- **受け入れ基準:**
  - AC.2.12.1.1: ヘルプビューで使用方法が表示される
  - AC.2.12.1.2: CSVフォーマットの詳細が表示される
  - AC.2.12.1.3: サンプルデータが表示される

---

## 3. 非機能要件

### 3.1 技術スタック

#### NFR.3.1.1 フロントエンド技術
- **要件:** React + TypeScript + Vite を使用する。
- **受け入れ基準:**
  - AC.3.1.1.1: 主要依存関係が適切に管理されている
  - AC.3.1.1.2: 開発サーバーが起動できる
  - AC.3.1.1.3: 本番ビルドが生成される

#### NFR.3.1.2 スタイリング
- **要件:** Tailwind CSSを使用し、カスタムクラスでサイバーパンク風UIを実現する。
- **受け入れ基準:**
  - AC.3.1.2.1: ダークテーマが適用される
  - AC.3.1.2.2: ネオンカラー（ブルー、ピンク、グリーン）が使用される
  - AC.3.1.2.3: グリッド背景パターンが表示される

---

### 3.2 パフォーマンス

#### NFR.3.2.1 レスポンス時間
- **要件:** ユーザー操作に対する応答時間は100ms以内とする。
- **受け入れ基準:**
  - AC.3.2.1.1: 検索入力時にリアルタイムで結果が更新される
  - AC.3.2.1.2: ソート操作が即座に反映される

#### NFR.3.2.2 ページネーション
- **要件:** 1ページあたり5件を表示する。
- **受け入れ基準:**
  - AC.3.2.2.1: 1ページあたり5件が表示される
  - AC.3.2.2.2: ページネーションが正しく動作する

---

### 3.3 データ保存

#### NFR.3.3.1 データ永続化
- **要件:** ブラウザのlocalStorageを使用してデータを保存する。
- **受け入れ基準:**
  - AC.3.3.1.1: データ変更時に自動保存される
  - AC.3.3.1.2: ページリロード後もデータが保持される
  - AC.3.3.1.3: データはJSON形式で保存される

---

### 3.4 ブラウザ互換性

#### NFR.3.4.1 対応ブラウザ
- **要件:** 最新のデスクトップブラウザ（Chrome, Firefox, Edge）とモバイルブラウザに対応する。
- **受け入れ基準:**
  - AC.3.4.1.1: 指定ブラウザで主要機能が動作する
  - AC.3.4.1.2: レスポンシブデザインが適切に動作する

---

### 3.5 テスト

#### NFR.3.5.1 テスト環境
- **要件:** テストフレームワークを使用してテストを実装する。
- **受け入れ基準:**
  - AC.3.5.1.1: テストが実行できる
  - AC.3.5.1.2: テストファイルが適切に配置される
  - AC.3.5.1.3: ユニットテストが実装されている

---

## 4. データ要件

### 4.1 データモデル

#### DR.4.1.1 Book型
- **要件:** 書籍データは以下の構造を持つ。
```typescript
interface Book {
  id: string;              // 一意のID（UUID）
  title: string;           // 書籍名（必須）
  author: string;          // 著者（必須）
  publisher: string;      // 出版社（任意）
  publishedYear: number;  // 出版年（必須）
  isbn: string;           // ISBN（任意）
  status: ReadStatus;     // 読書状況（unread/reading/read）
  isFavorite: boolean;    // お気に入り
  addedAt: string;       // 登録日時（ISO8601）
}
```
- **受け入れ基準:**
  - AC.4.1.1.1: 上記フィールドを含むJSONオブジェクトとして保存される
  - AC.4.1.1.2: `id`は一意である
  - AC.4.1.1.3: `addedAt`はISO8601形式の文字列である

#### DR.4.1.2 ActivityLog型
- **要件:** アクティビティログは以下の構造を持つ。
```typescript
interface ActivityLog {
  id: string;            // 一意のID（UUID）
  type: ActivityType;    // 操作タイプ
  message: string;       // メッセージ
  timestamp: string;    // タイムスタンプ（ISO8601）
}
```
- **受け入れ基準:**
  - AC.4.1.2.1: 上記フィールドを含むJSONオブジェクトとして保存される
  - AC.4.1.2.2: `timestamp`はISO8601形式の文字列である

---

### 4.2 CSV形式

#### DR.4.2.1 CSVインポート形式
- **要件:** CSVファイルは以下の形式に従う。
- **ヘッダー行:** `title,author,publisher,publishedYear,isbn,status,isFavorite`
- **必須項目:** `title`, `author`
- **任意項目:** `publisher`, `publishedYear`, `isbn`, `status`, `isFavorite`
- **受け入れ基準:**
  - AC.4.2.1.1: 上記形式のCSVファイルがインポートできる
  - AC.4.2.1.2: ヘッダー行は無視される
  - AC.4.2.1.3: 必須項目が欠けている場合はエラーが表示される

#### DR.4.2.2 CSVエクスポート形式
- **要件:** CSVエクスポートはUTF-8 BOM付きで生成される。
- **受け入れ基準:**
  - AC.4.2.2.1: UTF-8 BOM付きCSVファイルが生成される
  - AC.4.2.2.2: ファイル名は `Library_Export_YYYY-MM-DD.csv` 形式

---

## 5. インターフェース要件

### 5.1 ユーザーインターフェース

#### IR.5.1.1 UIデザイン
- **要件:** サイバーパンク風のダークテーマUIを実装する。
- **受け入れ基準:**
  - AC.5.1.1.1: ダークテーマが適用される
  - AC.5.1.1.2: ネオンカラーが使用される
  - AC.5.1.1.3: グリッド背景パターンが表示される

---

## 6. 制約事項・前提条件

### 6.1 技術的制約
- ブラウザのlocalStorageを使用するため、データは同一ブラウザ・同一ドメインでのみ有効
- ブラウザのキャッシュをクリアするとデータが消失する可能性がある
- サーバーサイドの実装は不要（フロントエンドのみ）

### 6.2 データ制約
- 書籍データはlocalStorageの容量制限（通常5-10MB）内に収める必要がある
- 同一タイトル・同一著者の書籍は重複として扱われる

---

## 7. 次工程への申し送り事項

### 7.1 実装時の注意事項
- データの後方互換性を維持すること
- localStorageのエラーハンドリングを実装すること
- CSVパース時のエラーハンドリングを実装すること

### 7.2 テスト要件
- 各機能要件に対して受け入れ基準を満たすテストを実装すること
- ユニットテストとコンポーネントテストを実装すること


